## Summary

**Pack v2 Contract M4: Prompt bundles.** Packs can ship optional prompt templates in `packs/{pack_id}/prompts/*.md`. When a pack with `schema_version "2"` is used, analysis, outreach, briefing, and ORE resolve prompts from the pack first and fall back to `app/prompts/` when a template is missing. Backward compatible: v1 packs and `pack=None` continue to use app prompts only.

Related to Pack v2 contract (Issue #285); implements Milestone M4 from the approved plan.

## Changes

| Area | Change |
|------|--------|
| **Pack loader** | `get_pack_dir(pack_id)` added for resolving pack root path (prompt bundle resolution). |
| **Prompts loader** | `load_prompt_from_pack(pack_dir, template_name)` loads from `pack_dir/prompts/{name}.md`; `resolve_prompt_content(template_name, pack, **vars)` tries pack prompts for v2 then app/prompts; `_render_template_content` shared by `render_prompt` and `resolve_prompt_content`. |
| **Analysis** | Uses `resolve_prompt_content(..., pack, **vars)` for stage, pain, and explanation prompts. |
| **Outreach** | Uses `resolve_prompt_content("outreach_v1", pack, ...)`. |
| **Briefing** | Resolves pack before building prompt; uses `resolve_prompt_content("briefing_entry_v1", pack, ...)`. |
| **ORE draft** | `generate_ore_draft(..., pack=None)` added; ORE pipeline passes `pack`; uses `resolve_prompt_content("ore_outreach_v1", pack, ...)`. |
| **Daily aggregation** | Pre-existing fixes: single docstring, duplicate block removed, `outreach_score_threshold=0` for ranked list; test expects `company_name`. |
| **Tests** | New tests for pack prompt resolution (no pack, v1 pack, v2 no prompts dir, v2 with pack file, `load_prompt_from_pack`); existing tests patch `resolve_prompt_content` and accept `pack` in mocks. |

## Verification

- `pytest tests/ -v -W error`
- `pytest tests/ -v --cov=app --cov-report=term-missing --cov-fail-under=75 -W error`
- `ruff check app/ tests/` — clean
- Snyk — no issues on changed code

## Backward compatibility

- **fractional_cto_v1** (schema_version `"1"`): No pack prompts dir used; all prompts from `app/prompts/`. Behavior unchanged.
- **pack=None**: `resolve_prompt_content` falls back to `load_prompt` (app/prompts). Unchanged.
- **Pack scoping**: No change to workspace_id or pack_id enforcement.

## Checklist

- [x] All tests pass (with `-W error`)
- [x] Linter (Ruff) clean
- [x] Snyk clean on changed code
- [x] No new migrations
- [x] Coverage ≥75% overall; modified prompt loader ≥85%
